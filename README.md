## TABS Model
Modified TABS model to run with data augmentation and Whole Head (WH) dataset

Adjusted code in:

TABS_model/train.py

TABS_model/test.py

To train the model, adjust the directory in the train.py and run
```
python train.py
```
with the appropriate arguments.


To test the model, adjust the directory in the test.py and run
```
python test.py
```
with the appropriate arguments.

## Diffusion Model

Modified MedSegDiff to run with TABS dataset. 
Original code in DIFF_OG, modified code in DIFF_model

Attempted addition of validation in train_util_new. Testing showed needed
around 30 seconds to perform image generation for one test image. Concluded
addition of validation loss as too computationally expensive.

Adjusted code in:

DIFF_model/scripts/segmentation_train.py

DIFF_model/scripts/segmentation_sample.py

DIFF_model/guided_diffusion/script_util

DIFF_model/guided_diffusion/isicloader.py

Code for performance on test sample in guided_diffusion/test_data_evaluation

test mask images generated by running segmentation_sample.py using trained model
evaluated in the notebook mentioned above

Run model by using same scripts as MedSegDiff:
Training:
```
python scripts/segmentation_train.py --data_dir (where you put data folder)/data/training --out_dir output data direction --image_size 192 --num_channels 128 --class_cond False --num_res_blocks 2 --num_heads 1 --learn_sigma True --use_scale_shift_norm False --attention_resolutions 16 --diffusion_steps 1000 --noise_schedule linear --rescale_learned_sigmas False --rescale_timesteps False --lr 1e-4 --batch_size 8
```
Sampling:
```
python scripts/segmentation_sample.py --data_dir (where you put data folder)/data/testing --out_dir output data direction --model_path saved model --image_size 256 --num_channels 128 --class_cond False --num_res_blocks 2 --num_heads 1 --learn_sigma True --use_scale_shift_norm False --attention_resolutions 16 --diffusion_steps 1000 --noise_schedule linear --rescale_learned_sigmas False --rescale_timesteps False --num_ensemble 5
```

